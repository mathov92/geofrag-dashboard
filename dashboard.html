<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geoøkonomisk Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Garamond', 'Georgia', serif;
            background: #DEDEDE;
            min-height: 100vh;
            padding: 20px;
        }
        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            color: #5A1C26;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.8em;
            font-weight: normal;
            letter-spacing: 0.02em;
        }
        .control-bar {
            background: white;
            border-radius: 4px;
            padding: 16px 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(77, 77, 77, 0.15);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }
        .filter-controls {
            display: flex;
            gap: 16px;
            align-items: center;
            flex-wrap: wrap;
        }
        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .filter-group label {
            color: #5A1C26;
            font-size: 0.9em;
            font-weight: 500;
        }
        .filter-group select, .filter-group input {
            padding: 6px 12px;
            border: 1px solid #E8E8E8;
            border-radius: 4px;
            font-family: inherit;
            font-size: 0.9em;
            background: white;
            color: #4D4D4D;
        }
        .filter-group select:hover, .filter-group input:hover {
            border-color: #2A6965;
        }
        .filter-group select:focus, .filter-group input:focus {
            outline: none;
            border-color: #2A6965;
            box-shadow: 0 0 0 2px rgba(42, 105, 101, 0.1);
        }
        .apply-filter-btn {
            background: #2A6965;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .apply-filter-btn:hover {
            background: #1F5651;
            transform: translateY(-1px);
        }
        .reset-filter-btn {
            background: #F5F5F5;
            color: #4D4D4D;
            border: 1px solid #E8E8E8;
            padding: 8px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .reset-filter-btn:hover {
            background: #E8E8E8;
        }
        .export-section {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        .export-btn {
            background: white;
            color: #6D6D6D;
            border: 1px solid #E8E8E8;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.85em;
            transition: all 0.3s ease;
        }
        .export-btn:hover {
            border-color: #2A6965;
            color: #2A6965;
        }
        .export-btn:active {
            transform: translateY(0);
        }
        .export-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        .status-bar {
            background: #EE3A36;
            border-radius: 4px;
            padding: 12px 24px;
            margin-bottom: 20px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .status { 
            font-size: 0.95em;
            letter-spacing: 0.01em;
        }
        .live-indicator {
            width: 10px;
            height: 10px;
            background: #6A8F7F;
            border-radius: 50%;
            animation: pulse 2s infinite;
            display: inline-block;
            margin-left: 10px;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .wide-card {
            background: white;
            border-radius: 4px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(77, 77, 77, 0.15);
            transition: transform 0.3s ease;
            border: 1px solid #E8E8E8;
            margin-bottom: 20px;
        }
        .wide-card:hover { 
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(77, 77, 77, 0.2);
        }
        .wide-card h2 {
            color: #5A1C26;
            margin-bottom: 18px;
            font-size: 1.4em;
            font-weight: normal;
            letter-spacing: 0.01em;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .card {
            background: white;
            border-radius: 4px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(77, 77, 77, 0.15);
            transition: transform 0.3s ease;
            border: 1px solid #E8E8E8;
        }
        .card:hover { 
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(77, 77, 77, 0.2);
        }
        .card h2 {
            color: #5A1C26;
            margin-bottom: 18px;
            font-size: 1.4em;
            font-weight: normal;
            letter-spacing: 0.01em;
        }
        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
            padding: 12px;
            background: #F5F5F5;
            border-radius: 4px;
            border: 1px solid #E8E8E8;
        }
        .metric-value {
            font-size: 1.4em;
            font-weight: bold;
            color: #2A6965;
        }
        .trend {
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 0.85em;
            font-weight: bold;
        }
        .trend.up { background: #FFEBE9; color: #EE3A36; }
        .trend.down { background: #E8F4F0; color: #2A6965; }
        canvas { max-height: 300px; }
        .loading {
            text-align: center;
            padding: 40px;
            color: #4D4D4D;
        }
        .citation {
            font-size: 0.8em;
            color: #6D6D6D;
            font-style: italic;
            margin-top: 12px;
            line-height: 1.5;
            letter-spacing: 0.01em;
        }
        .filter-info {
            background: #F5F5F5;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.85em;
            color: #5A1C26;
            margin-bottom: 12px;
            display: none;
        }
        .filter-info.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <h1>Geoøkonomisk Dashboard</h1>
        
        <div class="control-bar">
            <div class="filter-controls">
                <div class="filter-group">
                    <label for="startYear">Fra år:</label>
                    <select id="startYear">
                        <option value="2000">2000</option>
                        <option value="2005">2005</option>
                        <option value="2010">2010</option>
                        <option value="2015" selected>2015</option>
                        <option value="2016">2016</option>
                        <option value="2017">2017</option>
                        <option value="2018">2018</option>
                        <option value="2019">2019</option>
                        <option value="2020">2020</option>
                        <option value="2021">2021</option>
                        <option value="2022">2022</option>
                        <option value="2023">2023</option>
                        <option value="2024">2024</option>
                        <option value="2025">2025</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="endYear">Til år:</label>
                    <select id="endYear">
                        <option value="2015">2015</option>
                        <option value="2016">2016</option>
                        <option value="2017">2017</option>
                        <option value="2018">2018</option>
                        <option value="2019">2019</option>
                        <option value="2020">2020</option>
                        <option value="2021">2021</option>
                        <option value="2022">2022</option>
                        <option value="2023">2023</option>
                        <option value="2024">2024</option>
                        <option value="2025" selected>2025</option>
                    </select>
                </div>
                <button class="apply-filter-btn" onclick="applyFilters()">Anvend filter</button>
                <button class="reset-filter-btn" onclick="resetFilters()">Nulstil</button>
            </div>
            <div class="export-section">
                <button class="export-btn" id="exportBtn" onclick="exportToPDF()">
                    PDF ↓
                </button>
            </div>
        </div>

        <div class="status-bar">
            <div class="status">
                <span id="dataStatus">Loading data...</span>
                <span class="live-indicator" id="liveIndicator" style="display:none;"></span>
            </div>
            <div class="status">Sidste opdatering: <span id="lastUpdate">--</span></div>
        </div>

        <div class="filter-info" id="filterInfo"></div>

        <!-- Trade Openness Chart - Full Width -->
        <div class="wide-card">
            <h2>Handelsåbenhed (Handel/BNP %)</h2>
            <canvas id="tradeOpennessChart"></canvas>
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 15px;">
                <div class="metric">
                    <span>Verden</span>
                    <span class="metric-value" id="worldTrade">--</span>
                    <span class="trend down" id="worldTradeTrend">--</span>
                </div>
                <div class="metric">
                    <span>EU</span>
                    <span class="metric-value" id="euTrade">--</span>
                    <span class="trend down" id="euTradeTrend">--</span>
                </div>
                <div class="metric">
                    <span>Kina</span>
                    <span class="metric-value" id="chinaTrade">--</span>
                    <span class="trend up" id="chinaTradeTrend">--</span>
                </div>
                <div class="metric">
                    <span>USA</span>
                    <span class="metric-value" id="usaTrade">--</span>
                    <span class="trend up" id="usaTradeTrend">--</span>
                </div>
            </div>
            <div class="citation">
                Source: World Bank - Trade (% of GDP) Indicator
            </div>
        </div>

        <div class="grid">
            <!-- Currency Usage Trends -->
            <div class="card">
                <h2>Reservevaluta Status</h2>
                <canvas id="currencyChart"></canvas>
                <div class="metric">
                    <span>USD Dominance</span>
                    <span class="metric-value" id="usdShare">--</span>
                </div>
                <div class="citation">
                    Source: IMF Currency Composition of Official Foreign Exchange Reserves (COFER)
                </div>
            </div>

            <!-- FDI as % of GDP Comparison -->
            <div class="card">
                <h2>Indgående FDI % af BNP (åbenhed)</h2>
                <canvas id="fdiGdpChart"></canvas>
                <div class="grid" style="grid-template-columns: repeat(3, 1fr); margin-top: 15px;">
                    <div class="metric">
                        <span>USA</span>
                        <span class="metric-value" id="usaFdi">--</span>
                        <span class="trend down" id="usaTrend">--</span>
                    </div>
                    <div class="metric">
                        <span>Kina</span>
                        <span class="metric-value" id="chinaFdi">--</span>
                        <span class="trend down" id="chinaTrend">--</span>
                    </div>
                    <div class="metric">
                        <span>EU</span>
                        <span class="metric-value" id="euFdi">--</span>
                        <span class="trend down" id="euTrend">--</span>
                    </div>
                </div>
                <div class="citation">
                    Source: World Bank Foreign Direct Investment Database
                </div>
            </div>

            <!-- Harmful Trade Restrictions -->
            <div class="card">
                <h2>Skadelige handelsrestriktioner</h2>
                <div class="filter-info" id="restrictionsFilterInfo"></div>
                <canvas id="restrictionsChart"></canvas>
                <div class="metric">
                    <span>Samlede restriktioner</span>
                    <span class="metric-value" id="totalRestrictions">--</span>
                    <span class="trend up" id="restrictionsTrend">--</span>
                </div>
                <div class="citation">
                    Source: Global Trade Alert Database
                </div>
            </div>

            <!-- Geopolitical Risk Index -->
            <div class="card">
                <h2>Geopolitisk Risiko Indeks</h2>
                <div class="filter-info" id="geoFilterInfo"></div>
                <canvas id="geoRiskChart"></canvas>
                <div class="metric">
                    <span>Nuværende risikoniveau</span>
                    <span class="metric-value" id="currentRisk">--</span>
                    <span class="trend up" id="riskTrend">--</span>
                </div>
                <div class="citation">
                    Source: Caldara, Dario and Matteo Iacoviello (2022), "Measuring Geopolitical Risk"
                </div>
            </div>

            <!-- Trade Policy Uncertainty Index -->
            <div class="card">
                <h2>Handelspolitisk Usikkerhedsindeks</h2>
                <div class="filter-info" id="tpuFilterInfo"></div>
                <canvas id="tpuChart"></canvas>
                <div class="metric">
                    <span>Nuværende TPU niveau</span>
                    <span class="metric-value" id="currentTPU">--</span>
                    <span class="trend up" id="tpuTrend">--</span>
                </div>
                <div class="citation">
                    Source: Caldara, D., Iacoviello, M., Molligo, P., Prestipino, A., & Raffo, A. (2020). 
                    "The economic effects of trade policy uncertainty."
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const config = {
            staticDataPath: 'data/',
            githubRepo: 'mathov92/geofrag-dashboard',
            updateInterval: 300000
        };
